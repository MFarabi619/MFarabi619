<!DOCTYPE html>
<html lang="en" data-theme="synthwave">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ•¹ï¸ Microvisor Systems ğŸ•¹ï¸</title>
  <link rel="icon" type="image/svg+xml"
    href="https://raw.githubusercontent.com/MFarabi619/MFarabi619/6d07d279751dbb489f26b921b170d646f48422bc/assets/nix-mfarabi.svg" />

    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5/themes.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />

  <style>
    @keyframes float {
      0% { transform: translate(-3%, -2%) scale(0.95); opacity: 0.6; }
      100% { transform: translate(3%, 3%) scale(1.05); opacity: 0.8; }
    }
  </style>
</head>


<body class="min-h-screen overflow-x-hidden bg-zinc-950 text-gray-200 font-sans">
    <header class="navbar fixed top-0 left-0 w-full px-6 py-4
  backdrop-blur-xl shadow-md
  transition-all duration-300 z-50 hover:shadow-[0_0_25px_rgba(255,255,255,0.35)]">

      <a href="/" class="flex items-center gap-3
        transition-all duration-300 hover:scale-105 hover:drop-shadow-[0_0_12px_rgba(234,239,44,0.8)]">
        <img src="https://raw.githubusercontent.com/MFarabi619/MFarabi619/6d07d279751dbb489f26b921b170d646f48422bc/assets/nix-mfarabi.svg"
          alt="Microvisor Systems logo"
          class="h-12 rounded transition-all duration-300 hover:scale-110" />
        <span class="font-bold text-lg bg-[linear-gradient(90deg,#ffd200_0%,#ec8c78_33%,#e779c1_67%,#58c7f3_100%)] bg-clip-text text-transparent">
        Microvisor Systems</span>
    </a>

    <nav class="ml-auto flex items-center gap-3">
      <a class="btn btn-outline btn-warning" href="https://openws.org" target="_blank" rel="noopener noreferrer">
        OpenWS
      </a>

        <a href="https://github.com/microvisor-systems" target="_blank"
          class="btn btn-circle bg-white/10 backdrop-blur-xl border border-white/20
          transition-all duration-300 hover:bg-white/20
          hover:scale-110" aria-label="GitHub">
        <i class="devicon-github-original text-lg"></i>
      </a>

      <a href="https://ca.linkedin.com/company/microvisor-systems" rel="noopener noreferrer" target="_blank"
        class="btn btn-circle bg-white/10 backdrop-blur-xl border border-white/20
        transition-all duration-300 hover:bg-white/20
        hover:scale-110" aria-label="LinkedIn">
        <i class="devicon-linkedin-plain text-lg"></i>
      </a>
    </nav>
    </header>

  <div class="fixed inset-0 blur-[120px] saturate-[140%] opacity-60 pointer-events-none z-0" aria-hidden="true">
    <div
      class="absolute w-[60vmax] h-[60vmax] rounded-full opacity-60 mix-blend-screen will-change-[transform,opacity] animate-[float_25s_ease-in-out_infinite_alternate] [animation-delay:-6s] bg-[radial-gradient(circle,#cc00ff,transparent_70%)] top-[-20%] left-[-15%]">
    </div>
    <div
      class="absolute w-[60vmax] h-[60vmax] rounded-full opacity-60 mix-blend-screen will-change-[transform,opacity] animate-[float_25s_ease-in-out_infinite_alternate] [animation-delay:-12s] bg-[radial-gradient(circle,#ffee00,transparent_70%)] top-[-8%] left-[75%]">
    </div>
    <div
      class="absolute w-[60vmax] h-[60vmax] rounded-full opacity-60 mix-blend-screen will-change_[transform,opacity] animate-[float_25s_ease-in-out_infinite_alternate] [animation-delay:-18s] bg-[radial-gradient(circle,#00ff22,transparent_70%)] top-[75%] left-[40%]">
    </div>
  </div>

  <main class="relative z-10 flex flex-col items-center justify-center min-h-screen px-6 py-32 gap-10">
    <div class="hover-3d w-full max-w-3xl">
  <!-- content -->
          <section
      class="group bg-[rgba(255,255,255,0.06)] border border-[rgba(255,255,255,0.1)] backdrop-blur-[16px] shadow-[0_20px_60px_rgba(0,0,0,0.5)] rounded-[18px] px-8 py-6 text-center">
      <img
        class="drop-shadow-[0_0_20px_rgba(204,0,255,0.4)] drop-shadow-[0_0_12px_rgba(255,238,0,0.3)] transition-transform duration-300 ease-in-out h-auto mx-auto mb-6 w-[min(180px,35vmin)] group-hover:scale-105"
        src="https://raw.githubusercontent.com/MFarabi619/MFarabi619/6d07d279751dbb489f26b921b170d646f48422bc/assets/nix-mfarabi.svg"
        alt="Microvisor Systems logo" />

      <h1 class="font-extrabold text-[clamp(28px,4.5vmin,56px)] m-[0.5rem_0_0.25rem]">
        ğŸ•¹
        <span
          class="bg-[linear-gradient(90deg,#ffd200_0%,#ec8c78_33%,#e779c1_67%,#58c7f3_100%)] bg-clip-text text-transparent">
          Microvisor Systems
        </span>
        ğŸ•¹
      </h1>

      <p class="mt-3 text-[1.1rem] text-gray-200">
        ğŸ¤– Beep boop, from bootloader to browser ğŸ¤–
      </p>
          </section>

          <!-- 8 empty divs needed for the 3D effect -->
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>

    <section
      class="bg-[rgba(255,255,255,0.06)] border border-[rgba(255,255,255,0.1)] backdrop-blur-[16px] shadow-[0_20px_60px_rgba(0,0,0,0.5)] rounded-[18px] px-6 sm:px-10 py-8 w-full max-w-3xl">
        <div class="flex justify-center mb-4">
          <span
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-[rgba(255,255,255,0.12)] bg-[rgba(0,0,0,0.25)] text-xs tracking-wide text-gray-200/90">
            <span class="relative flex">
              <span class="absolute inline-flex w-2.5 h-2.5 rounded-full bg-emerald-400 shadow-[0_0_14px_rgba(16,185,129,0.8)] animate-ping"></span>
              <span class="relative w-2.5 h-2.5 rounded-full bg-emerald-400 shadow-[0_0_14px_rgba(16,185,129,0.8)]"></span>
            </span>
            Served from an ESP32
            <span class="opacity-70">â€¢</span>
            <span id="servedMeta" class="opacity-80">bootingâ€¦</span>
          </span>
        </div>

      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">

      <div class="mt-6 flex gap-3">
        <a href="/health" target="_blank"
          class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm btn btn-outline btn-success">
          <span class="inline-block w-2 h-2 rounded-full bg-emerald-400"></span>
          /health
        </a>

        <a href="/ready" target="_blank"
          class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm btn btn-outline btn-info ">
          <span class="inline-block w-2 h-2 rounded-full bg-sky-400"></span>
          /ready
        </a>

        <a href="/api/status" target="_blank"
          class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm btn btn-outline btn-primary">
          <span class="inline-block w-2 h-2 rounded-full bg-fuchsia-400"></span>
          /api/status
        </a>
      </div>

        <div class="flex items-center gap-2">
          <button id="refreshBtn"
            class="inline-flex items-center justify-center rounded-full px-4 py-2 text-sm border border-[rgba(255,255,255,0.14)] bg-[rgba(0,0,0,0.28)] hover:bg-[rgba(255,255,255,0.08)] transition">
            Refresh
          </button>
          <span id="statusPill"
            class="inline-flex items-center gap-2 px-3 py-2 rounded-full text-xs border border-[rgba(255,255,255,0.12)] bg-[rgba(0,0,0,0.25)] opacity-90">
            <span id="statusDot" class="inline-block w-2 h-2 rounded-full bg-zinc-500"></span>
            <span id="statusText">Loadingâ€¦</span>
          </span>
        </div>
      </div>

      <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div class="rounded-xl border border-[rgba(255,255,255,0.1)] bg-[rgba(0,0,0,0.22)] p-4">
          <div class="text-xs uppercase tracking-wider opacity-70">IP</div>
          <div id="ip" class="mt-1 text-lg font-semibold">â€”</div>
        </div>

        <div class="rounded-xl border border-[rgba(255,255,255,0.1)] bg-[rgba(0,0,0,0.22)] p-4">
          <div class="text-xs uppercase tracking-wider opacity-70">RSSI</div>
          <div id="rssi" class="mt-1 text-lg font-semibold">â€”</div>
        </div>

        <div class="rounded-xl border border-[rgba(255,255,255,0.1)] bg-[rgba(0,0,0,0.22)] p-4">
          <div class="text-xs uppercase tracking-wider opacity-70">Uptime</div>
          <div id="uptime" class="mt-1 text-lg font-semibold">â€”</div>
        </div>

        <div class="rounded-xl border border-[rgba(255,255,255,0.1)] bg-[rgba(0,0,0,0.22)] p-4">
          <div class="text-xs uppercase tracking-wider opacity-70">Free heap</div>
          <div id="heap" class="mt-1 text-lg font-semibold">â€”</div>
        </div>
      </div>

      <p id="err" class="mt-4 text-sm text-red-300 hidden"></p>
    </section>
  </main>

  <footer class="fixed bottom-2 w-full text-center opacity-70 text-[#b7b7c2] text-xs">
    Â© <span id="year"></span> Microvisor Systems
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    const el = (id) => document.getElementById(id);

    const servedMeta = el("servedMeta");
    const statusDot = el("statusDot");
    const statusText = el("statusText");
    const err = el("err");

    const ip = el("ip");
    const rssi = el("rssi");
    const uptime = el("uptime");
    const heap = el("heap");

    const fmtUptime = (s) => {
      s = Math.max(0, Number(s) || 0);
      const d = Math.floor(s / 86400); s %= 86400;
      const h = Math.floor(s / 3600);  s %= 3600;
      const m = Math.floor(s / 60);
      const sec = Math.floor(s % 60);
      const parts = [];
      if (d) parts.push(`${d}d`);
      if (h || d) parts.push(`${h}h`);
      if (m || h || d) parts.push(`${m}m`);
      parts.push(`${sec}s`);
      return parts.join(" ");
    };

    const setPill = (ok, msg) => {
      statusDot.className = "inline-block w-2 h-2 rounded-full " + (ok ? "bg-emerald-400" : "bg-red-400");
      statusText.textContent = msg;
    };

    const loadStatus = async () => {
      err.classList.add("hidden");
      setPill(true, "Updatingâ€¦");

      try {
        const res = await fetch("/api/status", { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const data = await res.json();

        ip.textContent = data.ip ?? "â€”";
        rssi.textContent = (data.rssi ?? "â€”") + (typeof data.rssi === "number" ? " dBm" : "");
        uptime.textContent = data.uptime_seconds != null ? fmtUptime(data.uptime_seconds) : "â€”";
        heap.textContent = data.heap != null ? `${data.heap.toLocaleString()} bytes` : "â€”";

        servedMeta.textContent = `${data.ip ?? "ESP32"} â€¢ RSSI ${data.rssi ?? "?"} dBm â€¢ up ${fmtUptime(data.uptime_seconds ?? 0)}`;

        setPill(true, "Live");
      } catch (e) {
        setPill(false, "Offline");
        servedMeta.textContent = "ESP32 reachable? ğŸ‘€";
        err.textContent = `Couldnâ€™t fetch /api/status: ${e.message}`;
        err.classList.remove("hidden");
      }
    };

    el("refreshBtn").addEventListener("click", loadStatus);

    loadStatus();
    setInterval(loadStatus, 3000);
  </script>
</body>
</html>
