views {
    view index {
        title: "Context/System"
        description: """
**Top Level** overview.
"""
        include *
        exclude microcontrollers
        exclude person
    }

    view platform of platform {
        title: "Platform"
        description: """
        General System Design.
        """

        include *
        include os.*
        include userspaces.**
        include kernels.**
    }

    view kernels of platform.kernels {
        title: "Kernels"
        description:  """
        Supported operating system back-ends.
        """
        include *
        include linux.**
    }

    view microcontrollers of microcontrollers {
        title: "Microcontrollers"
        description:  """
        Supported embedded devices.
        """
        include *
        include microcontrollers.**
    }

    view external-providers of external-providers {
        include *
        include google.*
        include ui-ux-design.*
        include software-development.*
        include marketing-and-communication.*
    }

dynamic view state-chart  {
title "Context/Statechart"

person -> external-providers.cloudflare "opens in browser" {
notes '''
- Any navigation to:
  - [openws.org](https://openws.org)
  - [*.openws.org](https://openws.org)
- Via `https`.
'''
}

 external-providers.cloudflare -> external-providers.cloudflare "resolve domain" {
notes '''
- Search CNAME Records.
- [Source](https://github.com/MFarabi619/MFarabi619/blob/main/config/providers/cloudflare.go)
'''
}

 external-providers.cloudflare -> caddy "tunnel to" {
notes '''
- Terminate TLS
  - `https` -> `http`.
- Points to self-hosted Caddy server.
- [Source](https://github.com/MFarabi619/MFarabi619/blob/main/modules/nixos/services/cloudflared.nix)

| ðŸ”´ | ðŸŸ¢ |
|-|-|
| Single point of failure | Easy `HTTPS` |
'''
}

parallel  {

 caddy -> caddy "lookup virtual hosts" {
notes '''
- Forward request to matching server.
- [Source](https://github.com/MFarabi619/MFarabi619/blob/main/modules/nixos/services/caddy.nix)

| ðŸ”´ | ðŸŸ¢ |
|-|-|
| Single point of attack | Single source of routing truth |
|  | Load Balancer |
'''

}

-> platform.landing-page "reverse proxy" {
notes '''
- [Source](https://github.com/MFarabi619/MFarabi619/blob/main/modules/nixos/services/caddy.nix)
'''
}

caddy -> platform.services.open-webui "reverse proxy" {
notes '''
- [Source](https://github.com/MFarabi619/MFarabi619/blob/main/modules/nixos/services/open-webui.nix)
'''
}

caddy -> platform.docs "reverse proxy"
}

platform.services.open-webui -> platform.services.ollama "calls"

include nixos
}
}

model {

nixos = component "NixOS" {
                    link https://nixos.org "Website"
                    icon https://raw.githubusercontent.com/NixOS/nixos-artwork/9d2cdedd73d64a068214482902adea3d02783ba8/logo/nix-snowflake-rainbow.svg
                    style {
                        color: blue
                        opacity: 40%
                    }

caddy = code "Caddy" {
link https://caddyserver.com "Website"
icon https://avatars.githubusercontent.com/u/12955528?s=200&v=4
style {
shape queue
color green
}
}
}
}
